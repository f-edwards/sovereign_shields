---
title: "Sovereign Shields: Law Enforcement and State Violence in Indian Country"
author: "Theresa Rocha Beardall and Frank Edwards"
output: binb::metropolis
---

```{r setup, echo = FALSE, message = FALSE, warning=FALSE}
rm(list=ls())
library(tidyverse)
library(broom)
library(knitr)
library(tinytex)
select<-dplyr::select
set.seed(1)

options(xtable.comment = FALSE)
theme_set(theme_bw())
# def.chunk.hook  <- knitr::knit_hooks$get("chunk")
# knitr::knit_hooks$set(chunk = function(x, options) {
#   x <- def.chunk.hook(x, options)
#   ifelse(options$size != "normalsize", paste0("\\", options$size,"\n\n", x, "\n\n \\normalsize"), x)
# })
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE, tidy = TRUE, size = "small")

library(maps)
source("main.R")
state_map<-map_data("state")
fe_st<-fe_st %>% 
  mutate(region=tolower(state))
```

## John Duane Fairbanks

\begin{scriptsize} \textbf{04/18/2019 Coon Rapids,	MN:} John Duane Fairbanks allegedly pulled a gun during a routine traffic stop and exchanged gunfire with Coon Rapids police about 1:30 a.m. After fleeing on foot and shooting at officers, Fairbanks hid in a nearby neighborhood. Officers found Fairbanks and exchanged gunfire again, this time killing him. Coon Rapids police Officer Alex Hattstrom and Anoka County sheriff's Deputy Christopher Vitek Jr. both fired their guns, and Coon Rapids police Officer Geoff Neumann reportedly discharged his Taser. \end{scriptsize}

\begin{center}
\includegraphics[height = 0.5\textheight]{./vis/John-Duane-Fairbanks.jpeg}
\end{center}

## Wendell Van Kee Howard Baier

**04/28/2019 Havre North,	MT:** A vehicle had been reported as stolen and was being pursued by the Havre Police Department when it collided with an eastbound vehicle. The driver of the vehicle that was reported stolen, Wendell Howard, was killed in the crash.

\begin{center}
\includegraphics[height = 0.5\textheight]{./vis/WendellHoward.jpg}
\end{center}

## Deion Grayhat

**05/18/2019 Tonalea, AZ:** Police killed Deion "Yonny" Grayhat in Tonolea but did not provide any information about the person killed or what precipitated the shooting.

\begin{center}
\includegraphics[height = 0.5\textheight]{./vis/Deion-Grayhat.jpg}
\end{center}

## American Indians / Alaksa Natives are at high risk of being killed by police 

|Sex|Race| Lifetime Deaths per 100,000| Risk ratio |
|---|----|----------------------------------:| ---:|
| M | AI/AN| 59   | 1.5 | 
| M | White | 40 | - |
| F | AI/AN| 4  | 2 |
| F | White | 2 | - |

\scriptsize \textit{Source}: Edwards, Lee and Esposito, 2019. "Risk of being killed by police use of force in the United States by age, race–ethnicity, and sex". Proceedings of the National Academy of Sciences, 116 (34)

## Police killings as a function of the political status of tribal nations

- Tribal nations are “domestic dependent” nations – wards of the federal government.
- Law structures colonial state violence through 1) legal history and 2) place-based legal structures

## Theory: Sovereign shields and state violence

- Does tribal sovereignty shield American Indians from state violence?     
     - Police violence (this paper)
     - Arrest and incarceration
     - Family separations through child welfare systems

## Native nationhood and law enforcement

*Historical Encounters with Law Enforcement*

- **1790s-1820s:** Treaties, Trade and Intercourse Period 
-	**1820s-1880s:** Removal and Reservation Period 
-	**1880s-1920s:** Allotment and Assimilation Period 
     - Indian Agents acted on behalf of the U.S. government in Indian Country
     
*Contemporary Encounters with Law Enforcement*

- **1920s-1940s:** Indian New Deal Period 
-	**1940s-1960s:** Termination Period 
     - PL 280, "shared" jurisdiction
- **1960s-Today:** Self-Determination Period 
     - Police act on behalf of federal, state, local, and tribal government in Indian Country

# Findings, data and methods

## Key findings

-	Police killings of American Indians are concentrated in states West of the Mississippi River. \pause
-	There are more killings by police in states where state and local law enforcement have jurisdiction on Indian lands. \pause
-	Killings occur most frequently in states with high levels of Native/White income inequality. \pause
-	Killings occur less frequently on reservations and tribal lands where communities operate their own courts and criminal justice institutions. 

## Data

- Fatal Encounters, 2000 - 2018, victims identified as American Indian / Alaska Native
- Census of Tribal Justice Agencies (CTJA) 2002
- American Community Survey (ACS) 2013 - 2017 5 year
- AFCARS
- CTJA linked to US Census American Indian Home Land shape files

## Measures

- FE: AI/AN Deaths, AI/AN Deaths on tribal land
- CTJA: tribal government has own legal institutions: [police, jail, courts]
- ACS: per capita income for states 
     - American Indian homeland / State ratios of poverty rates, unemployment rates
- PL 280 status: [mandatory, voluntary, non-PL 280]

## PL 280 by state

```{r}
plot_dat<-state_dat %>% 
  mutate(region = tolower(state)) %>% 
  left_join(state_map)

ggplot(plot_dat,
       aes(x=long, y = lat, fill = pl280,
           group = group)) + 
  geom_polygon(color = "black") + 
  theme_void() +
  labs(fill = "") +
  theme(legend.position = "bottom") +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) 

```

# Findings

## Police killings of American Indians and Alaska Natives, 2008 - 2018

\includegraphics[width=\linewidth]{./vis/map_aian_fe.png}

## Police killings of American Indians and Alaska Natives per year per 100,000 population, 2008 - 2018

```{r}
fe_yrs_n<-length(unique(fe_st$year))
fe_st_plot<-fe_st %>% 
  ungroup() %>% 
  group_by(region) %>% 
  summarise(value = mean(fe_deaths)/max(pop_aian_adult)* 1e5) %>%  # convert to deaths/100k/yr
  mutate(var="Deaths caused by police")

afcars_st_plot<-fe_st %>% 
  ungroup() %>% 
  group_by(region) %>% 
  summarise(value = mean(fc_caseload/pop_aian_child) * 100) %>% 
  mutate(var = "Foster care caseload")

plot_dat<-fe_st_plot %>% 
  bind_rows(afcars_st_plot) %>% 
  left_join(state_map)

ggplot(plot_dat %>% 
         filter(var=="Deaths caused by police"),
       aes(x=long, y = lat, fill = value,
           group = group)) + 
  geom_polygon(color = "black") + 
  theme_void() +
  labs(fill = "") +
  theme(legend.position = "bottom") +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  scale_fill_distiller(palette = "Spectral") 

```

## American Indian children in foster care as percent of child population, 2004-2017 annual average

```{r}
ggplot(plot_dat %>% 
         filter(var=="Foster care caseload"),
       aes(x=long, y = lat, fill = value,
           group = group)) + 
  geom_polygon(color = "black") + 
  theme_void() +
  labs(fill = "") +
  theme(legend.position = "bottom") +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  scale_fill_distiller(palette = "Spectral") 

```

## Police killings and foster care caseloads by state, in mean-centered standard deviation units

```{r}
ggplot(plot_dat %>% 
         group_by(var) %>% 
         mutate(value = scale(value)),
       aes(x=long, y = lat, fill = value,
           group = group)) + 
  geom_polygon(color = "black") + 
  theme_void() +
  labs(fill = "") +
  theme(legend.position = "bottom") +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  scale_fill_distiller(palette = "Spectral") + 
  facet_wrap(~var)
```

## Percent of AIAN children in state foster care in AIAN foster homes, 2004 - 2017 average

```{r}
afcars_st_plot<-fe_st %>% 
  ungroup() %>% 
  group_by(region) %>% 
  summarise("Caseload" = mean(fc_caseload/pop_aian_child, na.rm=TRUE) * 100,
            "Entries" = mean(fc_entered/pop_aian_child, na.rm=TRUE) *100,
            "Institutionalized" = mean(fc_inst/fc_caseload, na.rm=TRUE)*100,
            "In AIAN foster home" = mean(fc_aian_home, na.rm=TRUE)*100) %>% 
  pivot_longer(cols=c(Caseload, Entries, Institutionalized, `In AIAN foster home`), 
               names_to = "var",
               values_to = "value") %>% 
  group_by(var) %>% 
  left_join(state_map)
                    
ggplot(afcars_st_plot %>% 
         filter(var=="In AIAN foster home"),
       aes(x=long, y = lat, fill = value,
           group = group)) + 
  geom_polygon(color = "black") + 
  theme_void() +
  labs(fill = "") +
  theme(legend.position = "bottom") +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  scale_fill_distiller(palette = "Spectral") 
```

## Proportion of tribal governments with independent police, with arrest authority over tribal members off of tribal lands, with arrest authority over non-Indians on tribal lands, and with detention facilities, 2002

```{r}
police_plot<-fe_st %>% 
  ungroup() %>% 
  group_by(region) %>% 
  summarise("Tribal police" = mean(police_tribal),
            "Arrest members off tribal land" = mean(police_tribal_off_res),
            "Arrest non-Indians on tribal land" = mean(police_tribal_non_ind),
            "Detention" = mean(jail)) %>% 
  pivot_longer(cols=c("Tribal police":"Detention"), 
               names_to = "var",
               values_to = "value") %>% 
  group_by(var) %>% 
  left_join(state_map) %>% 
  ungroup() %>% 
  mutate(var = factor(var,
                      levels = c("Tribal police", 
                                 "Arrest members off tribal land",
                                 "Arrest non-Indians on tribal land", 
                                 "Detention")))

ggplot(police_plot,
       aes(x=long, y = lat, fill = value,
           group = group)) + 
  geom_polygon(color = "black") + 
  theme_void() +
  labs(fill = "") +
  theme(legend.position = "bottom") +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  scale_fill_distiller(palette = "Spectral") + 
  facet_wrap(~var)
```

## Proportion of tribal governments with independent courts, courts handling misdemeanors, and family courts, 2002

```{r}
courts_plot<-fe_st %>% 
  ungroup() %>% 
  group_by(region) %>% 
  summarise("Courts" = mean(courts),
            "Courts, misdemeanor" = mean(courts_misd),
            "Courts, civil" = mean(courts_civil),
            "Courts, family" = mean(courts_family)) %>% 
  pivot_longer(cols=c("Courts":"Courts, family"), 
               names_to = "var",
               values_to = "value") %>% 
  group_by(var) %>% 
  left_join(state_map) %>% 
  ungroup() 

ggplot(courts_plot,
       aes(x=long, y = lat, fill = value,
           group = group)) + 
  geom_polygon(color = "black") + 
  theme_void() +
  labs(fill = "") +
  theme(legend.position = "bottom") +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  scale_fill_distiller(palette = "Spectral") + 
  facet_wrap(~var)
```

## Models

```{r}

### for now, use state period average
### and quasipoission glm

fe_st_avg<-fe_st %>% 
  filter(.imp==1) %>% 
  group_by(stusps) %>% 
  summarise(fe_deaths = sum(fe_deaths),
            pc_income_ineq = mean(pc_income_ineq),
            fc_entered = ceiling(mean(fc_entered)),
            fc_istpr = ceiling(mean(fc_istpr)),
            fc_caseload = ceiling(mean(fc_caseload)),
            fc_aian_home = mean(fc_aian_home),
            pop_aian_child = ceiling(mean(pop_aian_child)),
            pop_aian_adult = ceiling(mean(pop_aian_adult)))

fe_st_fixed<-fe_st %>% 
  filter(.imp==1) %>% 
  select(stusps, pl280, west_MS,
         police_tribal, police_tribal_off_res,
         police_tribal_non_ind, jail, courts, 
         courts_misd, courts_civil, courts_family,
         pop_pct_aian_aianh, pov_ratio) %>% 
  distinct()

fe_st_model<-fe_st_avg %>% 
  left_join(fe_st_fixed)

m_fc<-glm(fc_caseload ~ 
            pl280 + west_MS +
            police_tribal +
            police_tribal_non_ind +
            courts_misd +
            courts_civil +
            courts_family +
            pop_pct_aian_aianh,
          data = fe_st_model,
          family = "quasipoisson",
          offset =log(pop_aian_child))

m_tpr<-glm(fc_istpr ~ 
            pl280 + west_MS +
            police_tribal +
            police_tribal_non_ind +
            courts_misd +
            courts_civil +
            courts_family +
            pop_pct_aian_aianh,
          data = fe_st_model,
          family = "quasipoisson",
          offset =log(pop_aian_child))

m_aian_home<-lm(fc_aian_home ~ 
            pl280 + west_MS +
            police_tribal +
            police_tribal_non_ind +
            courts_misd +
            courts_civil +
            courts_family +
            pop_pct_aian_aianh + 
            log(pop_aian_child),
          data = fe_st_model)

m_fe<-glm(fe_deaths ~ 
            pl280 + west_MS +
            police_tribal +
            police_tribal_non_ind +
            courts_misd +
            courts_civil +
            courts_family +
            pop_pct_aian_aianh,
          data = fe_st_model,
          family = "quasipoisson",
          offset =log(pop_aian_adult))

### simulation data
stusps<-"XX"
year<-2020
pop_aian_adult<-1e5
pop_aian_child<-1e5
pl280<-c("Mandatory", "Optional", "Non-PL280")
police_tribal<-seq(1,0)
police_tribal_off_res<-c(1,0)
police_tribal_non_ind<-seq(0,1,0.01)
pop_pct_aian_aianh<-0.2
jail<-c(1,0)
courts<-c(1,0)
courts_misd<-c(1,0)
courts_civil<-c(1,0)
courts_family<-seq(0,1,0.01)
west_MS<-c(T)

newdata<-expand_grid(stusps, year, west_MS,
                     pop_aian_adult, pop_aian_child,
                     pop_pct_aian_aianh,
                     pl280, police_tribal, police_tribal_off_res,
                     jail, courts_civil,
                     police_tribal_non_ind, courts,
                     courts_misd, courts_family)


newdata$fe_yhat<-predict(m_fe, newdata, type = "response")
newdata$fc_cl_yhat<-predict(m_fc, newdata, type = "response")
newdata$fc_aian_home_yhat<-predict(m_aian_home, newdata, type = "response")
newdata$fc_tpr_yhat<-predict(m_tpr, newdata, type = "response")


## predict fe along police, police_tribal_off_res

ggplot(newdata %>% 
         filter(police_tribal==1, police_tribal_off_res==1,
                courts==1, courts_misd==1, courts_civil==1, 
                courts_family==1),
       aes(x=police_tribal_non_ind, y = fe_yhat/10, #deaths/100k/yr
           color = pl280)) +
  geom_line() +
  ylab("AIAN deaths per 100,000 per year") +
  xlab("Proportion of agencies with arrest powers over non-Indians") + 
  labs(color = "PL-280")

```


<!-- #### q0: do tribal lands protect aminds?  -->
<!-- #### - is risk higher on tribal than non-tribal lands? -->
<!-- #### this needs to diff out pop and killings from state total -->
<!-- #### for later: urban rates diff from other groups? -->

<!-- #### q1: are aminds where quality of life on tribal lands >  -->
<!-- #### qol in state less likely to be killed? -->

<!-- #### q2: presence of tribal police force? -->

<!-- ### state-level: aian risk as function of ineq -->
<!-- ### aian risk as function of avg sovereignty / disadv -->

<!-- ###LATER _ MANUALLY CODE RACE ON ALL CASES ON OR WITHIN X MILES OF AIANH -->

<!-- ############################################################ -->
<!-- ### descriptives -->
<!-- ############################################################ -->
<!-- ### state: killings per cap -->
<!-- ### natl: aian deaths on / not on aianh -->
<!-- ### aianh: by law enf agency type -->
<!-- ### by aian / not aian on aianh - look at missing -->

<!-- #### MAKE MAP OF THIS DATA! 3x2 FACET -->

<!-- ### simple correlations -->
<!-- ### hs/unemp/pov tightly correlated -->
<!-- ### negative on income/pov as expected -->

<!-- # ggplot(state_dat,  -->
<!-- #        aes(x = pov_ratio, -->
<!-- #            y = st_income_ineq)) +  -->
<!-- #   geom_point() +  -->
<!-- #   geom_smooth(method = "lm") +  -->
<!-- #   ggsave("vis/bivar_pov_income.png") -->
<!-- #  -->
<!-- # ggplot(state_dat,  -->
<!-- #        aes(x = pov_ratio, -->
<!-- #            y = unemp_ratio)) +  -->
<!-- #   geom_point() +  -->
<!-- #   geom_smooth(method = "lm") +  -->
<!-- #   ggsave("vis/bivar_pov_unemp.png") -->
<!-- #  -->
<!-- # ggplot(state_dat,  -->
<!-- #        aes(x = pov_ratio, -->
<!-- #            y = hs_ratio)) +  -->
<!-- #   geom_point() +  -->
<!-- #   geom_smooth(method = "lm") +  -->
<!-- #   ggsave("vis/bivar_pov_hs.png") -->
<!-- #  -->
<!-- # ggplot(state_dat,  -->
<!-- #        aes(x = pov_ratio, -->
<!-- #            y = sqrt(fe_rt_aian))) +  -->
<!-- #   geom_point() +  -->
<!-- #   geom_smooth(method = "lm") +  -->
<!-- #   ggsave("vis/bivar_pov_fe.png") -->
<!-- #  -->
<!-- # ggplot(state_dat,  -->
<!-- #        aes(x = st_income_ineq, -->
<!-- #            y = sqrt(fe_rt_aian))) +  -->
<!-- #   geom_point() +  -->
<!-- #   geom_smooth(method = "lm") +  -->
<!-- #   ggsave("vis/bivar_inc_fe.png") -->
<!-- #  -->
<!-- # ggplot(state_dat,  -->
<!-- #        aes(x = aianh_pct_tribal_police, -->
<!-- #            y = sqrt(fe_rt_aian))) +  -->
<!-- #   geom_point() +  -->
<!-- #   geom_smooth(method = "lm") +  -->
<!-- #   ggsave("vis/bivar_tribal_police_fe.png") -->
<!-- #  -->
<!-- # ggplot(state_dat,  -->
<!-- #        aes(x = aianh_pct_tribal_police, -->
<!-- #            y = aianh_pct_tribal_jail)) +  -->
<!-- #   geom_point() +  -->
<!-- #   geom_smooth(method = "lm") +  -->
<!-- #   ggsave("vis/bivar_tribal_police_jail.png") -->
<!-- #  -->
<!-- # ggplot(state_dat,  -->
<!-- #        aes(x = aianh_pct_tribal_police, -->
<!-- #            y = aianh_pct_tribal_courts)) +  -->
<!-- #   geom_point() +  -->
<!-- #   geom_smooth(method = "lm") +  -->
<!-- #   ggsave("vis/bivar_tribal_police_courts.png") -->


<!-- #################################################### -->
<!-- #### MODELS -->
<!-- #################################################### -->

<!-- ############ STATE LEVEL ############  -->
<!-- library(lme4) -->
<!-- state_dat$obs_n<-1:nrow(state_dat) -->




<!-- s0<-glmer(fe_aian ~  -->
<!--             log(st_income_ineq) +   -->
<!--             pl280 + (1|year) + (1|stusps), -->
<!--           data = state_dat, -->
<!--           offset = log(total_population_amind), -->
<!--           family = "poisson") -->

<!-- s1<-glmer(fe_aian ~  -->
<!--             log(st_income_ineq) +   -->
<!--             west_MS + pl280 +  -->
<!--             (1|year) + (1|stusps), -->
<!--           data = state_dat, -->
<!--           offset = log(total_population_amind), -->
<!--           family = "poisson") -->
<!-- ### make scenarios for low-high income ineq, west/east of MS: no pl280 -->
<!-- ### west of MS, pl280 all scens. 4 sequences of st_income -->
<!-- fake_dat<-data.frame(st_income_ineq = rep( -->
<!--   seq(from = 0.5, to = 1, length.out = 1000), 4), -->
<!--   pl280 = c(rep("Non-PL280", 2000), -->
<!--             rep("Optional", 1000), -->
<!--             rep("Mandatory", 1000)), -->
<!--   west_MS = c(rep(FALSE, 1000), -->
<!--               rep(TRUE, 3000)), -->
<!--   year = rep(2018, 4000), -->
<!--   stusps = rep("MN", 4000), -->
<!--   total_population_amind = rep(1e5, 4000) -->
<!-- ) -->

<!-- fake_dat$yhat<-predict(s1, newdata = fake_dat, -->
<!--                        re.form = ~0) -->

<!-- ggplot(fake_dat, -->
<!--        aes(x = st_income_ineq, -->
<!--            y = exp(yhat) * 1e5, -->
<!--            color = pl280, -->
<!--            lty = !west_MS)) +  -->
<!--   geom_line() +  -->
<!--   labs(y = "Deaths per 100,000", -->
<!--        color = "Public Law 280 State", -->
<!--        lty = "West of Mississippi River", -->
<!--        x = "Native / White income ratio") +  -->
<!--   ggsave("./vis/preds_state.png") -->

<!-- ggplot(fake_dat, -->
<!--        aes(x = st_income_ineq, -->
<!--            y = exp(yhat) * 1e5, -->
<!--            color = pl280, -->
<!--            lty = west_MS)) +  -->
<!--   geom_line() +  -->
<!--   labs(y = "Deaths per 100,000", -->
<!--        color = "Public Law 280 State", -->
<!--        lty = "West of Mississippi River", -->
<!--        x = "Native / White income ratio") +  -->
<!--   ggsave("./vis/preds_state.pdf") -->

<!-- ############ AIANH LEVEL ############  -->
<!-- ### disadvantage -->


<!-- h4a<-glm(fe_aian ~  -->
<!--                 scale(pov_rt) + scale(unemp_rt) + scale(hs_rt) +  -->
<!--                 scale(log(pc_income_amind)) +  -->
<!--               offset(log(total_population_amind)) , -->
<!--               data = aianh_dat, -->
<!--               family = "quasipoisson") -->

<!-- # h4a_ml<-glmer(fe_aian ~  -->
<!-- #              scale(pov_rt) + scale(unemp_rt) + scale(hs_rt) +  -->
<!-- #              scale(log(pc_income_amind)) +  -->
<!-- #              (1|state), -->
<!-- #            offset = log(total_population_amind) , -->
<!-- #            data = aianh_dat, -->
<!-- #            family = "poisson") -->

<!-- ### sovereignty (legal institutions) -->

<!-- h5a_0<-glm(fe_aian ~  -->
<!--              police_tribal +  -->
<!--              police_tribal_staterecog +  -->
<!--              jail_tribal + juv_tribal +  -->
<!--              courts +  -->
<!--              pl280 +  -->
<!--              offset(log(total_population_amind + 1)) , -->
<!--            data = aianh_dat, -->
<!--            family = "quasipoisson") -->

<!-- h5a_1<-update(h5a_0,  -->
<!--               .~. +  -->
<!--                 scale(pov_rt) + scale(unemp_rt) + scale(hs_rt) +  -->
<!--                 scale(log(pc_income_amind))) -->

<!-- ############ SIMULATION ############  -->
<!-- ############ SOVEREIGNTY / PL280 -->
<!-- mean_dat<-aianh_dat%>% -->
<!--   summarise_all(mean, na.rm = TRUE)%>% -->
<!--   mutate(total_population_amind = 1e5) -->

<!-- fake_dat_sov<-aianh_dat[1:6,] -->
<!-- fake_dat_sov[1:6, ]<-mean_dat[1,]  -->

<!-- TF<-c(TRUE, FALSE) -->
<!-- PL280<-c("Mandatory", "Optional", "Non-PL280") -->
<!-- rep_dat<-expand.grid(TF, PL280) -->
<!-- rep_TF<-function(x)x=rep_dat$Var1 -->
<!-- fake_dat_sov<-fake_dat_sov%>% -->
<!--   mutate_at(vars(police_tribal, police_tribal_staterecog, -->
<!--                        jail_tribal, juv_tribal,  -->
<!--                        courts), rep_TF)%>% -->
<!--   mutate(pl280 = rep_dat$Var2)%>% -->
<!--   select(police_tribal, police_tribal_staterecog, -->
<!--          jail_tribal, juv_tribal,  -->
<!--          courts, pov_rt, unemp_rt, hs_rt, pc_income_amind, -->
<!--          pl280, -->
<!--          total_population_amind) -->

<!-- yhat<-predict(h5a_1, newdata = fake_dat_sov,  -->
<!--         se.fit = TRUE) -->

<!-- fake_dat_sov<-fake_dat_sov%>% -->
<!--   mutate(pred = exp(yhat$fit),  -->
<!--          pred_upr = exp(yhat$fit + yhat$se.fit), -->
<!--          pred_lwr = exp(yhat$fit - yhat$se.fit)) -->

<!-- ggplot(fake_dat_sov, -->
<!--        aes(x = police_tribal, -->
<!--            y = pred, -->
<!--            ymin = pred_lwr, -->
<!--            ymax = pred_upr)) +  -->
<!--   geom_errorbar() +  -->
<!--   facet_wrap(~pl280) +  -->
<!--   xlab("Tribal legal institutions present") +  -->
<!--   ylab("Deaths per 100,000") +  -->
<!--   # labs(title = "Predicted American Indians killed by police by PL280 status", -->
<!--   #      subtitle = "Mean prediction +/- 1 SE") +  -->
<!--   ggsave("vis/preds_pl280.png") -->

<!-- ############ Structural disadvantage -->
<!-- ### same six scens as above +  -->
<!-- ### min-max disadvantage -->
<!-- ### vary from min:max by (max-min)/1000 -->
<!-- ### for each of pov_rt, unemp_rt, hs_rt, pc_income (range from max:min) -->
<!-- len<-1e3 -->
<!-- make_seq<-function(x){ -->
<!--   out<-seq(from =  -->
<!--              quantile(x, 0.1, na.rm = TRUE), -->
<!--            to = quantile(x, 0.9, na.rm=TRUE),  -->
<!--            length.out = len) -->
<!--   return(out)} -->

<!-- make_seq_desc<-function(x){ -->
<!--   out<-seq(from =  -->
<!--              quantile(x, 0.9, na.rm = TRUE), -->
<!--            to = quantile(x, 0.1, na.rm=TRUE),  -->
<!--            length.out = len) -->
<!--   return(out)} -->

<!-- ### stack scenarios -->
<!-- ### loop over each row in fake_dat_sov, make len df, bind -->
<!-- scen_out<-list() -->
<!-- for(i in 1:nrow(fake_dat_sov)){ -->
<!--   fake_dat_sov<-as.data.frame(fake_dat_sov) -->
<!--   scen_temp<-data.frame(police_tribal =  -->
<!--                           rep(fake_dat_sov[i,"police_tribal"], len), -->
<!--                         police_tribal_staterecog =  -->
<!--                           rep(fake_dat_sov[i,"police_tribal_staterecog"], len), -->
<!--                         jail_tribal =  -->
<!--                           rep(fake_dat_sov[i,"jail_tribal"], len), -->
<!--                         juv_tribal =  -->
<!--                           rep(fake_dat_sov[i,"juv_tribal"], len), -->
<!--                         courts =  -->
<!--                           rep(fake_dat_sov[i,"courts"], len), -->
<!--                         pl280 =  -->
<!--                           rep(fake_dat_sov[i, "pl280"]), -->
<!--                         pov_rt = make_seq(aianh_dat$pov_rt), -->
<!--                         unemp_rt = make_seq(aianh_dat$unemp_rt), -->
<!--                         hs_rt = make_seq(aianh_dat$hs_rt), -->
<!--                         pc_income_amind = make_seq_desc(aianh_dat$pc_income_amind), -->
<!--                         total_population_amind = rep(1e5, len), -->
<!--                         index = seq(from = 0.1, to = 0.9, length.out = len) -->
<!--                         ) -->
<!--   scen_out[[i]]<-scen_temp -->
<!-- } -->

<!-- scen_out<-bind_rows(scen_out) -->

<!-- yhat<-predict(h5a_1, newdata = scen_out, -->
<!--               se.fit = TRUE) -->

<!-- scen_out<-scen_out%>% -->
<!--   mutate(pred = exp(yhat$fit)/19,  -->
<!--          pred_upr = exp(yhat$fit + yhat$se.fit)/19, -->
<!--          pred_lwr = exp(yhat$fit - yhat$se.fit)/19) -->

<!-- ggplot(scen_out%>% -->
<!--          rename(`Tribal legal institutions` = courts),  -->
<!--        aes(x = index,  -->
<!--            y = pred, -->
<!--            ymax = pred_upr, -->
<!--            ymin = pred_lwr, -->
<!--            color = `Tribal legal institutions`, -->
<!--            fill = `Tribal legal institutions`)) +  -->
<!--   geom_line() +  -->
<!--   geom_ribbon(alpha = 0.2, color = NA) +  -->
<!--   facet_wrap(~pl280) + -->
<!--   xlab("Structural disadvantage (quantile)") +  -->
<!--   ylab("Deaths per 100,000") +  -->
<!--   theme(legend.position = "bottom") +  -->
<!--   labs(fill = "Tribal legal institutions present", -->
<!--        color = "Tribal legal institutions present") +  -->
<!--   ggsave("vis/preds_disadv.png") -->

<!-- ggplot(scen_out%>% -->
<!--          rename(`Tribal legal institutions` = courts),  -->
<!--        aes(x = index,  -->
<!--            y = pred, -->
<!--            ymax = pred_upr, -->
<!--            ymin = pred_lwr, -->
<!--            color = `Tribal legal institutions`, -->
<!--            fill = `Tribal legal institutions`)) +  -->
<!--   geom_line() +  -->
<!--   geom_ribbon(alpha = 0.2, color = NA) +  -->
<!--   facet_wrap(~pl280) + -->
<!--   xlab("Structural disadvantage (quantile)") +  -->
<!--   ylab("Deaths per 100,000") +  -->
<!--   theme(legend.position = "bottom") +  -->
<!--   labs(fill = "Tribal legal institutions present", -->
<!--        color = "Tribal legal institutions present") +  -->
<!--   ggsave("vis/preds_disadv.pdf") --> 

State models (state by year 2013 - 2018):

\[deaths \sim Poisson(\lambda) \]
\[log(E[deaths|X]) = \lambda = \beta X + \alpha_{state} + \zeta_{year} + log(pop) \]

American Indian home land models (pooled 2000 - 2018):

\[deaths \sim QuasiPoisson(\lambda, \theta) \]
\[log(E[deaths|X]) = \theta = \beta X + log(pop)\]
\[var(deaths) = \theta \cdot \lambda \]


<!-- ## Predicted American Indian deaths on tribal lands per 100,000 persons per year  -->

<!-- \begin{center} -->
<!-- \includegraphics[height = 0.9\textheight]{./vis/preds_disadv.pdf} -->
<!-- \end{center} -->

<!-- ## Predicted American Indian deaths in states per 100,000 persons per year -->


<!-- \begin{center} -->
<!-- \includegraphics[height = 0.9\textheight]{./vis/preds_state.pdf} -->
<!-- \end{center} -->

# Discussion 

##  Next steps

*Theoretical implications*

- Legacies of colonization drive police killings of American Indians 
- Sovereignty may act as a shield \pause

*Next steps*

- Other forms of state violence: arrest, incarceration, family separation \pause
- More sophisticated measures of tribal sovereignty \pause
- 71 percent of AI/AN population is in urban metros \pause
- Do tribal sovereigns have effects beyond their borders?

## Thank you 

- Theresa: tyr5@cornell.edu
- Frank: frank.edwards@rutgers.edu